# Product Requirements Document V1.2 (Prototype Implementation Review)

**Project:** Orchard Planner GPT
**Date:** November 05, 2025
**Version:** 1.1

## 1. Overview & Goal

This document outlines the features and technical specifications of the interactive prototype for Orchard Planner GPT. The purpose of the application remains to help small-scale orchard owners transition from reactive guesswork to data-driven decision-making.

This version (v1.2) updates the initial plan (v1.0) to reflect the functionality that has been successfully implemented in the current prototype, detailing the specific AI integrations, technical architecture, and user experience choices made during this phase of development.

## 2. Core Features (Implemented)

The prototype is a functional Single-Page Application (SPA) demonstrating the core user flows.

- **Dashboard (Home):**
  - **Status:** Complete
  - **Description:** Displays a static weather card, a list of the top 3 priority tasks, and the most recent AI-generated alert. Serves as the user's daily summary.

- **Task Manager:**
  - **Status:** Complete
  - **Description:** A full CRUD (Create, Read, Update, Delete) interface for farm tasks. Users can add tasks, set a priority, mark them as complete, and delete them.

- **Field Log:**
  - **Status:** Complete
  - **Description:** A form for inputting text-based observations. Submitting a log triggers the AI analysis.
  - **AI Functionality:** Yes

- **AI Assistant Chat:**
  - **Status:** Complete
  - **Description:** An interactive chat interface for users to ask natural language questions.
  - **AI Functionality:** Yes

- **Alerts Page:**
  - **Status:** Complete
  - **Description:** A chronological list of all proactive insights and warnings generated by the AI.
  - **AI Functionality:** Yes

## 3. AI Specification

The prototype integrates the Google Gemini API, specifically the `gemini-2.5-flash` model, to act as "OrchardAI," an expert agronomist.

- **What AI Does:**
  1.  **Proactive Alert Generation:** The AI analyzes a user's field observation against weather data to generate a predictive risk alert (Low, Medium, or High) and an actionable recommendation.
  2.  **Conversational Q&A:** The AI provides expert answers to general horticultural questions asked by the user in a chat interface.

- **Where it Appears in the User Flow:**
  1.  **Alert Generation:** The AI process is triggered automatically when a user submits an entry on the **Field Log** page. The resulting alert is displayed on the **Dashboard** and added to the list on the **Alerts** page.
  2.  **AI Assistant:** The AI is engaged directly by the user on the **AI Assistant** page, where they can send and receive messages in a chat window.

- **Model Used:** The `gemini-2.5-flash` model from the Google Gemini API is used for both text generation tasks due to its balance of speed and reasoning capabilities suitable for a responsive user experience.

## 4. Technical Architecture

The prototype was implemented with the following technologies:

- **Frontend Framework:** **React** with **TypeScript** for a modern, type-safe, and component-based structure.
- **Styling:** **Tailwind CSS** for rapid and responsive UI development.
- **Application Structure:** A **Single-Page Application (SPA)** model, where components are dynamically rendered to simulate multi-page navigation without page reloads.
- **AI Integration:** The official **`@google/genai`** client library is used for all API calls to the Gemini model.
- **Data Handling:** Application state (tasks, logs, alerts) is managed within React's state hooks. There is no backend database; data is ephemeral and resets on page refresh.
- **Hosting:** The static application is deployed and suitable for hosting on platforms like GitHub Pages.

## 5. Prompting Strategy & Iteration Log

Effective prompting was critical to achieving the desired AI behavior.

### Prompt 1: Initial Alert Generation (Too Vague)
- **Prompt:** `"User log: 'Saw 5 apple scab lesions in Block C.' Weather: 'Rain tomorrow.' What should the user do?"`
- **Result:** The AI produced a conversational paragraph, such as: "Given that you've seen apple scab and rain is coming, it's a good idea to take action. You should probably consider spraying a fungicide."
- **Refinement:** This response was not structured and could not be parsed by the application to create a categorized alert. The prompt needed to be more specific and request a machine-readable format.

### Prompt 2: Refined Alert Generation (Structured Output)
- **Prompt:** A detailed system instruction was added to define the AI's persona, and a `responseSchema` was included in the API call to force a JSON output.
    - **System Instruction Snippet:** `"You are 'OrchardAI,' an expert agronomist... Your response must be a valid JSON object matching the provided schema."`
    - **User Prompt Snippet:** `"Context: ... Weather: ${weatherData}. User Log: '${logText}'. Task: Analyze... and generate a high-priority alert."`
- **Result:** The AI consistently returned a clean JSON object: `{ "risk": "High", "recommendation": "High risk of apple scab spread... Recommend applying preventative fungicide within 48 hours." }`
- **Refinement:** This was highly effective and is the version currently implemented in the prototype. It allows the application to easily parse the risk level and recommendation.

### Prompt 3: AI Assistant Persona
- **Prompt:** A system instruction was created to guide the AI's conversational style.
    - **System Instruction:** `"You are 'OrchardAI,' an expert agronomist... Be concise, clear, and actionable. Keep your answers brief... Include a disclaimer to 'always confirm with your local extension office' when recommending specific actions."`
- **Result:** The AI now adopts the correct persona, provides focused answers, and includes the necessary disclaimer, aligning with the project's goal of being a helpful but cautious assistant.
- **Refinement:** Initially, the AI responses were too long. The instruction "Keep your answers brief and to the point" was added to make the chat experience more suitable for a mobile screen.

## 6. UX & Design Notes

- **User Experience:** The design is **mobile-first**, utilizing a simple bottom navigation bar for intuitive switching between core features. The SPA architecture ensures a fast, fluid experience similar to a native application.
- **Interface Design:** The UI uses a clean, card-based layout to present information clearly. The color palette (`brand-green`, `brand-brown`) was chosen to evoke an agricultural, natural feel. Visual cues, such as colors for task priority and alert risk levels (Red for High, Yellow for Medium, Green for Low), provide at-a-glance information.
- **Limitations & Tradeoffs:**
    - **No Data Persistence:** As a frontend-only prototype, all user-created data (tasks, logs, etc.) is lost on refresh. This was a deliberate tradeoff to simplify development.
    - **Mock Weather Data:** The weather information is currently static. This was done to focus on the core AI interaction with the field log rather than on third-party API integration for this phase.

## 7. Next Steps (Phase 3)

The following areas are priorities for the next phase of development:

1.  **Strengthen AI Integration:**
    - Integrate a live weather API (e.g., OpenWeatherMap) to provide real-time, location-specific weather data as context for the AI alerts.
    - Enhance the AI Assistant by allowing it to read from the user's task and alert history for more personalized advice.

2.  **Add Core Features & Interactivity:**
    - Implement a backend service and database (e.g., Firebase) to enable user accounts and data persistence.
    - Allow users to upload images in the Field Log and utilize a multimodal model to analyze them for visual signs of pests or disease.

3.  **Polish Design & UX:**
    - Refine the user interface with smoother transitions, animations, and better visual feedback on user actions.
    - Add data visualization to the dashboard to show trends in logs and alerts over time.
